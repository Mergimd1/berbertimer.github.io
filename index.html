<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Agoni Barber</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#f5f5f5;
}
.header{
  background:#0d1b2a;
  color:white;
  padding:40px 20px;
  text-align:center;
}
.card{
  background:white;
  margin:20px;
  padding:20px;
  border-radius:15px;
  box-shadow:0 4px 15px rgba(0,0,0,0.1);
}
input, select{
  width:100%;
  padding:10px;
  margin-top:10px;
}
button{
  background:#e63946;
  color:white;
  border:none;
  padding:12px;
  width:100%;
  border-radius:10px;
  margin-top:15px;
  font-size:16px;
}
.success{
  color:green;
}
.error{
  color:red;
}
</style>
</head>

<body>

<div class="header">
<h1>AGONI BARBER</h1>
<p>Rezervo Termin Online</p>
</div>

<div class="card">
<h3>Rezervo Termin</h3>

<label>Shërbimi</label>
<select id="service">
<option>Qethje - 5€</option>
<option>Qethje + Rroje - 6€</option>
<option>Styler - 2€</option>
</select>

<label>Data</label>
<input type="date" id="date">

<label>Ora</label>
<select id="time">
<option>09:00</option>
<option>09:30</option>
<option>10:00</option>
<option>10:30</option>
<option>11:00</option>
<option>11:30</option>
<option>12:00</option>
<option>13:00</option>
<option>14:00</option>
<option>15:00</option>
<option>16:00</option>
</select>

<input type="text" id="name" placeholder="Emri juaj">
<input type="text" id="phone" placeholder="Numri i telefonit">

<button onclick="reserve()">Rezervo Tani</button>

<p id="message"></p>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAvOR7GVNRjoSHwRlmiJsMptnodnlhTL-k",
  authDomain: "agonibarber.firebaseapp.com",
  projectId: "agonibarber",
  storageBucket: "agonibarber.firebasestorage.app",
  messagingSenderId: "195737259673",
  appId: "1:195737259673:web:a129ea0024d0802e173208"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.reserve = async function(){

  const service = document.getElementById("service").value;
  const date = document.getElementById("date").value;
  const time = document.getElementById("time").value;
  const name = document.getElementById("name").value;
  const phone = document.getElementById("phone").value;
  const message = document.getElementById("message");

  if(!date || !name || !phone){
    message.innerHTML = "Plotëso të gjitha fushat!";
    message.className="error";
    return;
  }

  const q = query(
    collection(db,"appointments"),
    where("date","==",date),
    where("time","==",time)
  );

  const querySnapshot = await getDocs(q);

  if(!querySnapshot.empty){
    message.innerHTML="Kjo orë është e zënë!";
    message.className="error";
    return;
  }

  await addDoc(collection(db,"appointments"),{
    service,
    date,
    time,
    name,
    phone,
    createdAt: new Date()
  });

  message.innerHTML="Rezervimi u krye me sukses!";
  message.className="success";

}

</script>

</body>
</html>
